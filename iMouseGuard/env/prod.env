# create the env folder if it does not exist
install -d -m 755 /opt/iMouseGuard/env

# write the env file
cat > /opt/iMouseGuard/env/prod.env <<'EOF'
# iMouse Guard env

# install root
export IMOUSEGUARD_HOME="/opt/iMouseGuard"

# Event Server websocket
export WS_URL="ws://127.0.0.1:9000"
export WS_SEND_AUTH="0"            # set 1 only if ES requires WS auth
export WS_RETRY_SEC="3"
export WS_PING_INTERVAL="30"
export WS_PING_TIMEOUT="10"
export WS_RECV_TIMEOUT="300"
export SEEN_MAX="500"

# Telegram bot config
export TELEGRAM_TOKEN="8454911744:AAHuqeq3AcUNf7IX2DMgE_iug1vJz1bTez4"
export TELEGRAM_CHAT_ID="-1002597925763"
export TELEGRAM_THREAD_ID="3"      # leave empty if you do not use topics
message  thread id - 26200   # litter/drinking 

# Zoneminder base URL for links in alerts
# change to your real UI if different
export IMOUSE_ZM_BASE_URL="http://10.0.2.2"
EOF

# lock it down
chmod 600 /opt/iMouseGuard/env/prod.env

# load it into your current shell
. /opt/iMouseGuard/env/prod.env

# quick sanity check
python3 - <<'PY'
import os
for k in ["IMOUSEGUARD_HOME","WS_URL","WS_SEND_AUTH","TELEGRAM_TOKEN","TELEGRAM_CHAT_ID","TELEGRAM_THREAD_ID","IMOUSE_ZM_BASE_URL"]:
    print(k, "=", repr(os.getenv(k)))
PY


https://api.telegram.org/bot8454911744:AAHuqeq3AcUNf7IX2DMgE_iug1vJz1bTez4/getUpdates
